INSERT INTO `!PREFIX!_mod` VALUES (21, 1, 'Search_Input', 'Content', 'none', 'Search input box', NULL, '', '<?php\r\n/**\r\n* $RCSfile$\r\n*\r\n* Description: Search input box\r\n*\r\n* @version 1.0.0\r\n* @author Rudi Bieller\r\n* @copyright four for business AG <www.4fb.de>\r\n*\r\n* {@internal\r\n* created 2008-04-07\r\n* }}\r\n*/\r\n\r\nif (!isset($tpl) || !is_object($tpl)) {\r\n    $tpl = new Template();\r\n}\r\n$tpl->reset();\r\n\r\n$sTargetIdcat = getEffectiveSetting(''search-results'', ''idcat'', ''1'');\r\n$sTargetIdart = getEffectiveSetting(''search-results'', ''idart'', ''1'');\r\n$sFormAction = ''front_content.php?idcat=''.$sTargetIdcat.''&amp;idart=''.$sTargetIdart;\r\n\r\n$tpl->set(''s'', ''form_action'', $sFormAction);\r\n$tpl->set(''s'', ''label_search'', mi18n("Suche"));\r\n$tpl->generate(''templates/search_input.html'');\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 15:59:48', '2013-09-14 14:56:55');
INSERT INTO `!PREFIX!_mod` VALUES (22, 1, 'Search_Output', 'Content', 'none', 'Search output box', NULL, '', '<?php\r\n/**\r\n* $RCSfile$\r\n*\r\n* Description: Search output box\r\n*\r\n* @version 1.0.1\r\n* @author Willi Man\r\n* @copyright four for business AG <www.4fb.de>\r\n*\r\n* {@internal\r\n* created 2004-05-04\r\n* modified 2005-07-12 Andreas Lindner\r\n* modified 2008-04-11 Rudi Bieller\r\n* modified 2008-05-06 Rudi Bieller Added CON_SEARCH_MAXLEN_TEASERTEXT; Fixed <nobr> to be xhtml compliant;\r\n*                       Removed $action, $sCatName = getCategoryName($cat_id, $db); which was not used at all and \r\n*                       added a default output in case article/module was called directly (strlen(trim($searchterm)) == 0)\r\n* modified 2013-12-23 Spider IT Deutschland - Rene Mansveld: Output a part of the article text where at least one of\r\n*                       the search terms is included\r\n* }}\r\n*\r\n* $Id$\r\n*/\r\n\r\n#System properties in use:\r\n#Type: searchrange, Name: include\r\n#Contains comma-separated list of cats to be included into search (sub-cats are included automatically)\r\n\r\n#Logical combination of search terms with AND or OR\r\n\r\ndefine(''CON_SEARCH_ITEMSPERPAGE'', 10);\r\ndefine(''CON_SEARCH_MAXLEN_TEASERTEXT'', 300);\r\n\r\n#Includes\r\ncInclude(''includes'', ''functions.api.string.php'');\r\n\r\n#Initiliaze template object\r\nif (!is_object($tpl)) {\r\n    $tpl = new Template;\r\n}\r\n$tpl->reset();\r\n\r\n#Settings\r\n$oArticleProp = new Article_Property($db, $cfg);\r\n$iArtspecReference = 2;\r\n\r\n$cApiClient = new cApiClient($client);\r\n$sSearchRange = $cApiClient->getProperty(''searchrange'', ''include'');\r\n$aSearchRange = explode('','', $sSearchRange);\r\n\r\n#Multilingual settings\r\n$sYourSearchFor = mi18n("Ihre Suche nach");\r\n$sMore = mi18n("weiterlesen");\r\n\r\n#Get search term and pre-process it\r\nif (isset ($_GET[''searchterm''])) {\r\n    $searchterm = urldecode(htmlentities(strip_tags(stripslashes($_GET[''searchterm'']))));\r\n}\r\nelseif (isset ($_POST[''searchterm''])) {\r\n    $searchterm = urldecode(htmlentities(strip_tags(stripslashes($_POST[''searchterm'']))));\r\n}\r\n$searchterm = str_replace('' + '', '' AND '', $searchterm);\r\n$searchterm = str_replace('' - '', '' NOT '', $searchterm);\r\n$searchterm_display = $searchterm;\r\n\r\n#Get all article specs\r\n$sql = "SELECT\r\n        idartspec, artspec\r\n    FROM\r\n        ".$cfg[''tab''][''art_spec'']."\r\n    WHERE\r\n        client=$client AND\r\n        lang=$lang AND\r\n        online=1";\r\n\r\n$db->query($sql);\r\n$rows = $db->num_rows();\r\n$aArtspecOnline = array ();\r\n$aArtSpecs = array ();\r\n$c = 1;\r\n$d = 1;\r\n$e = 1;\r\nwhile ($db->next_record()) {\r\n    $aArtSpecs[] = $db->f(''idartspec'');\r\n}\r\n$aArtSpecs[] = 0;\r\n\r\nif (strlen(trim($searchterm)) > 0) {\r\n    #Fix for PHP < 4.3\r\n    if( !function_exists( ''html_entity_decode'' ) )\r\n    {\r\n        function html_entity_decode( $given_html, $quote_style = ENT_QUOTES )\r\n        {\r\n            $trans_table = array_flip(conGetHtmlTranslationTable( HTML_SPECIALCHARS, $quote_style ));\r\n            $trans_table[''&#39;''] = "''";\r\n            return ( strtr( $given_html, $trans_table ) );\r\n        }\r\n    }\r\n\r\n    #Parse search term and set search options\r\n    $searchterm = html_entity_decode($searchterm);\r\n\r\n    if (stristr($searchterm, '' or '') === FALSE) {\r\n        $combine = ''and'';\r\n    } else {\r\n        $combine = ''or'';\r\n    }\r\n    $searchterm = str_replace('' and '', '' '', strtolower($searchterm));\r\n    $searchterm = str_replace('' or '', '' '', strtolower($searchterm));\r\n\r\n    $options = array (''db'' => ''regexp'', // use db function regexp\r\n                    ''combine'' => $combine, // combine searchterms with and\r\n                    ''exclude'' => false, // => searchrange specified in ''cat_tree'', ''categories'' and ''articles'' is excluded, otherwise included (exclusive)\r\n                    ''cat_tree'' => $aSearchRange, // searchrange \r\n                    ''artspecs'' => $aArtSpecs, // array of article specifications => search only articles with these artspecs\r\n                    ''protected'' => true); // => do not search articles or articles in categories which are offline or protected\r\n\r\n    $search = new Search($options);\r\n\r\n    $cms_options = array ("head", "html", "htmlhead", "htmltext", "text"); // search only in these cms-types\r\n    $search->setCmsOptions($cms_options);\r\n\r\n    #Execute search\r\n    $aSearchResults = $search->searchIndex($searchterm, ''''); \r\n\r\n    #Build results page\r\n    if (count($aSearchResults) > 0) {\r\n        $tpl->set(''s'', ''result_page'', mi18n("Ergebnis-Seite").'':'');\r\n\r\n        #Build meessage\r\n        $message = $sYourSearchFor." ''<strong>".strip_tags($searchterm_display)."</strong>'' ".mi18n("hat $$$ Treffer ergeben").":";\r\n        $message = str_replace(''$$$'', count($aSearchResults), $message);\r\n        $tpl->set(''s'', ''MESSAGE'', $message);\r\n\r\n        #Number of results per page\r\n        $number_of_results = CON_SEARCH_ITEMSPERPAGE;\r\n        $oSearchResults = new SearchResult($aSearchResults, $number_of_results);\r\n\r\n        $num_res = $oSearchResults->getNumberOfResults() + $pdf_count;\r\n        $num_pages = $oSearchResults->getNumberOfPages();\r\n        #$oSearchResults->setReplacement(''<strong>'', ''</strong>''); // html-tags to emphasize the located searchterms\r\n\r\n        #Get current result page\r\n        if (isset ($_GET[''page'']) && is_numeric($_GET[''page'']) && $_GET[''page''] > 0) {\r\n            $page = $_GET[''page''];\r\n            $res_page = $oSearchResults->getSearchResultPage($page);\r\n        } else {\r\n            $page = 1;\r\n            $res_page = $oSearchResults->getSearchResultPage($page);\r\n        }\r\n\r\n        #Build links to other result pages\r\n        for ($i = 1; $i <= $num_pages; $i ++) {\r\n            // this is just for sample client - modify to your needs!\r\n            if ($cfg[''url_builder''][''name''] == ''front_content'' || $cfg[''url_builder''][''name''] == ''MR'') {\r\n                $aParams = array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($i.$sArtSpecs));\r\n            } else {\r\n                $aParams = array(''search'' => array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($i.$sArtSpecs)), \r\n                                ''idcat'' => $idcat, // needed to build category path\r\n                                ''lang'' => $lang, // needed to build category path\r\n                                ''level'' => 1); // needed to build category path\r\n            }\r\n            try {\r\n                $nextlink = Contenido_Url::getInstance()->build($aParams);\r\n            } catch (InvalidArgumentException $e) {\r\n                $nextlink = $sess->url(''front_content.php?idcat=''.$idcat.''&amp;idart=''.$idart.''&amp;searchterm=''.$searchterm.''&amp;page=''.$i.$sArtSpecs);\r\n            }\r\n            if ($i == $page) {\r\n                $nextlinks .= ''<span style="white-space:nowrap;">&nbsp;<strong>''.$i.''</strong>&nbsp;</span>'';\r\n            } else {\r\n                $nextlinks .= ''<span style="white-space:nowrap;">&nbsp;<a href="''.$nextlink.''" title="''.$i.''. ''.mi18n("Ergebnisseite anzeigen").''">''.$i.''</a>&nbsp;</span>'';\r\n            }\r\n        }\r\n        $tpl->set(''s'', ''PAGES'', $nextlinks);\r\n\r\n        #Build link to next result page\r\n        if ($page < $num_pages) {\r\n            $n = $page +1;\r\n            // this is just for sample client - modify to your needs!\r\n            if ($cfg[''url_builder''][''name''] == ''front_content'' || $cfg[''url_builder''][''name''] == ''MR'') {\r\n                $aParams = array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($n.$sArtSpecs));\r\n            } else {\r\n                $aParams = array(''search'' => array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($n.$sArtSpecs)), \r\n                                ''idcat'' => $idcat, // needed to build category path\r\n                                ''lang'' => $lang, // needed to build category path\r\n                                ''level'' => 1); // needed to build category path\r\n            }\r\n            try {\r\n                $next = Contenido_Url::getInstance()->build($aParams);\r\n            } catch (InvalidArgumentException $e) {\r\n                $next = $sess->url(''front_content.php?idcat=''.$idcat.''&amp;idart=''.$idart.''&amp;searchterm=''.$searchterm.''&amp;page=''.$n.$sArtSpecs);\r\n            }\r\n            $nextpage .= ''&nbsp;<a href="''.$next.''" title="''.mi18n("n&auml;chste Ergebnisseite anzeigen").''">''.mi18n("vor").''</a>'';\r\n            $tpl->set(''s'', ''NEXT'', $nextpage);\r\n        } else {\r\n            $tpl->set(''s'', ''NEXT'', '''');\r\n        }\r\n\r\n        #Build link to previous result page\r\n        if ($page > 1) {\r\n            $p = $page -1;\r\n            // this is just for sample client - modify to your needs!\r\n            if ($cfg[''url_builder''][''name''] == ''front_content'' || $cfg[''url_builder''][''name''] == ''MR'') {\r\n                $aParams = array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($p.$sArtSpecs));\r\n            } else {\r\n                $aParams = array(''search'' => array(''lang'' => $lang, ''idcat'' => $idcat, ''idart'' => $idart, ''searchterm'' => $searchterm, ''page'' => ($p.$sArtSpecs)), \r\n                                ''idcat'' => $idcat, // needed to build category path\r\n                                ''lang'' => $lang, // needed to build category path\r\n                                ''level'' => 1); // needed to build category path\r\n            }\r\n            try {\r\n                $pre = Contenido_Url::getInstance()->build($aParams);\r\n            } catch (InvalidArgumentException $e) {\r\n                $pre = $sess->url(''front_content.php?idcat=''.$idcat.''&amp;idart=''.$idart.''&amp;searchterm=''.$searchterm.''&amp;page=''.$p.$sArtSpecs);\r\n            }\r\n            $prevpage .= ''<a href="''.$pre.''" title="''.mi18n("vorherige Ergebnisseite anzeigen").''">''.mi18n("zur&uuml;ck").''</a>&nbsp;'';\r\n            $tpl->set(''s'', ''PREV'', $prevpage);\r\n        } else {\r\n            $tpl->set(''s'', ''PREV'', '''');\r\n        }\r\n\r\n        if (count($res_page) > 0) {\r\n            $i = 1;\r\n            #Build single search result on result page\r\n            foreach ($res_page as $key => $val) {\r\n                $num = $i + (($page -1) * $number_of_results);\r\n                $oArt = new Article($key, $client, $lang);\r\n                #Get publishing date of article\r\n                $pub_system = $oArt->getField(''published'');\r\n                $pub_user = trim(strip_tags($oArt->getContent(''HEAD'', 90)));\r\n                if ($pub_user != '''') {\r\n                    $show_pub_date = "[".$pub_user."]";\r\n                } else {\r\n                    $show_pub_date = '''';\r\n                    if ($pub_system[8] != ''0'') {\r\n                        $show_pub_date .= $pub_system[8];\r\n                    }\r\n                    $show_pub_date .= $pub_system[9].''.'';\r\n                    if ($pub_system[5] != ''0'') {\r\n                        $show_pub_date .= $pub_system[5];\r\n                    }\r\n                    $show_pub_date .= $pub_system[6].".".$pub_system[0].$pub_system[1].$pub_system[2].$pub_system[3]."]";\r\n                    $show_pub_date = "[".$show_pub_date;\r\n                }\r\n            \r\n                #Get text and headline of current article\r\n                $iCurrentArtSpec = $oArticleProp->getArticleSpecification($key, $lang);\r\n                $aHeadline = $oSearchResults->getSearchContent($key, ''HTMLHEAD'', 1);\r\n                $aSubheadline = $oSearchResults->getSearchContent($key, ''HTMLHEAD'', 2);\r\n                $text = $oSearchResults->getSearchContent($key, ''HTML'', 1);\r\n                \r\n                # Pick a part of the text where at least one of the search terms is included\r\n                $asTerms = explode('' '', $searchterm);\r\n                $key_words = $oSearchResults->search_result[$key][''keyword''];\r\n                $key_words = array_unique($key_words);\r\n                $key_words = $oSearchResults->sortByLength($key_words, true);\r\n                $pos = false;\r\n                for ($j = 0, $n = count($asTerms); $j < $n; $j ++) {\r\n                    $p = preg_match(''/\\b'' . strtolower(htmlentities($asTerms[$j])) . ''\\b/ui'', strtolower(htmlentities(html_entity_decode(strip_tags($text[0]), ENT_COMPAT, $encoding[$lang]), ENT_COMPAT, $encoding[$lang])), $result, PREG_OFFSET_CAPTURE);\r\n                    if ($p == 1) {\r\n                        $pos = $result[0][1];\r\n                        break;\r\n                    }\r\n                }\r\n                if ($pos === false) {\r\n                    # Pick a part of the text where at least one of the found terms is included\r\n                    for ($j = 0, $n = count($key_words); $j < $n; $j ++) {\r\n                        $p = preg_match(''/\\b'' . strtolower(htmlentities($key_words[$j])) . ''\\b/ui'', strtolower(htmlentities(html_entity_decode(strip_tags($text[0]), ENT_COMPAT, $encoding[$lang]), ENT_COMPAT, $encoding[$lang])), $result, PREG_OFFSET_CAPTURE);\r\n                        if ($p == 1) {\r\n                            $pos = $result[0][1];\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if ($pos > 30) {\r\n                    $text[0] = ''&hellip;'' . substr($text[0], strlen(capiStrTrimAfterWord($text[0], ((mb_strlen(substr($text[0], ($pos - 30))) < CON_SEARCH_MAXLEN_TEASERTEXT) ? -CON_SEARCH_MAXLEN_TEASERTEXT : ($pos - 30)))));\r\n                }\r\n                $text = capiStrTrimAfterWord($text[0], CON_SEARCH_MAXLEN_TEASERTEXT);\r\n                $headline = capiStrTrimAfterWord($aHeadline[0], CON_SEARCH_MAXLEN_TEASERTEXT);\r\n                $subheadline = capiStrTrimAfterWord($aSubheadline[0], CON_SEARCH_MAXLEN_TEASERTEXT);\r\n                \r\n                # Emphasize the seach and found words in the resulting texts\r\n                $search_words   = $oSearchResults->search_result[$key][''search''];\r\n                $search_words   = array_unique($search_words);\r\n                $search_words   = $oSearchResults->sortByLength($search_words, true);\r\n                $mark_words     = $oSearchResults->sortByLength(array_unique(array_merge($search_words, $key_words)), true);\r\n                $aTags          = array(''<strong class="searchResult">'', ''</strong>'');\r\n                $text           = $oSearchResults->emphasize($text, $mark_words, $aTags);\r\n                $headline       = $oSearchResults->emphasize($headline, $mark_words, $aTags);\r\n                $subheadline    = $oSearchResults->emphasize($subheadline, $mark_words, $aTags);\r\n                \r\n                $cat_id = $oSearchResults->getArtCat($key);\r\n                $similarity = $oSearchResults->getSimilarity($key);\r\n                $similarity = sprintf("%.0f", $similarity);\r\n\r\n                #Send output to template\r\n                // this is just for sample client - modify to your needs!\r\n                if ($cfg[''url_builder''][''name''] == ''front_content'' || $cfg[''url_builder''][''name''] == ''MR'') {\r\n                    if (isStartArticle(getArtLang($key, $lang), $cat_id, $lang)) {\r\n                        $aParams = array(''lang'' => $lang, ''idcat'' => $cat_id);\r\n                    } else {\r\n                        $aParams = array(''lang'' => $lang, ''idcat'' => $cat_id, ''idart'' => $key);\r\n                    }\r\n                } else {\r\n                    if (isStartArticle(getArtLang($key, $lang), $cat_id, $lang)) {\r\n                        $aParams = array(''search'' => array(''lang'' => $lang, ''idcat'' => $cat_id), \r\n                                        ''idcat'' => $idcat, // needed to build category path\r\n                                        ''lang'' => $lang, // needed to build category path\r\n                                        ''level'' => 1); // needed to build category path\r\n                    } else {\r\n                        $aParams = array(''search'' => array(''lang'' => $lang, ''idcat'' => $cat_id, ''idart'' => $key), \r\n                                        ''idcat'' => $idcat, // needed to build category path\r\n                                        ''lang'' => $lang, // needed to build category path\r\n                                        ''level'' => 1); // needed to build category path\r\n                    }\r\n                }\r\n                try {\r\n                    $href = Contenido_Url::getInstance()->build($aParams);\r\n                } catch (InvalidArgumentException $e) {\r\n                    $href = $sess->url("front_content.php?idcat=$cat_id&amp;idart=$key");\r\n                }\r\n                $tpl->set(''d'', ''more'', $sMore);\r\n                $tpl->set(''d'', ''HREF'', $href);\r\n                $tpl->set(''d'', ''TITLE'', mi18n("Link zu Suchergebnis").'' ''.$i);\r\n                $tpl->set(''d'', ''NUM'', $num);\r\n                $tpl->set(''d'', ''CATNAME'', ((strlen($headline)) ? $headline : mi18n("(Keine &Uuml;berschrift vorhanden)")));\r\n                $tpl->set(''d'', ''HEADLINE'', $text);\r\n                $tpl->set(''d'', ''SUBHEADLINE'', $subheadline);\r\n                $tpl->set(''d'', ''SIMILARITY'', str_replace(''|1'', $similarity, mi18n("&Uuml;bereinstimmung: |1%")));\r\n                $tpl->set(''d'', ''TARGET'', ''_self'');\r\n                $tpl->set(''d'', ''PUB_DATE'', $show_pub_date);\r\n                $tpl->next();\r\n                $i ++;\r\n\r\n            }\r\n            $tpl->generate(''templates/search_output.html'');\r\n        }\r\n    } else {\r\n        #No results\r\n        $tpl->set(''s'', ''MESSAGE'', $sYourSearchFor." ''"."<strong>".htmlspecialchars(strip_tags($searchterm))."</strong>"."'' ".mi18n("hat leider keine Treffer ergeben").".");\r\n        $tpl->set(''s'', ''NEXT'', '''');\r\n        $tpl->set(''s'', ''PREV'', '''');\r\n        $tpl->set(''s'', ''PAGES'', '''');\r\n        $tpl->set(''s'', ''result_page'', '''');\r\n        $tpl->generate(''templates/search_output.html'');\r\n    }\r\n\r\n} else {\r\n    echo ''<div id="content">'';\r\n    echo ''<div id="searchResults">'';\r\n    echo ''''.mi18n("Keine Suchergebnisse - Bitte suchen Sie &uuml;ber das Sucheingabefeld!").'''';\r\n    echo ''</div>'';\r\n    echo ''</div>'';\r\n}\r\n\r\nclass Article_Property {\r\n    var $globalConfig;\r\n    var $oDBInstance;\r\n\r\n    /**\r\n     * Constructor\r\n     * Hint: Call constructor with Article_Property($db, $cfg);\r\n     * @param  oDBInstance instance of class DB\r\n     * @param  globalConfig \r\n     */\r\n    function Article_Property($oDBInstance, $globalConfig) {\r\n        $this->globalConfig = $globalConfig;\r\n        $this->oDBInstance = $oDBInstance;\r\n    }\r\n\r\n    /**\r\n     * Get specification of an article\r\n     * \r\n     * @param   $iArticleId\r\n     * @return  id of article specification \r\n     */\r\n    function getArticleSpecification($iArticleId, $iLangId) {\r\n\r\n        $sqlString = "   \r\n                    SELECT \r\n                        artspec\r\n                    FROM \r\n                        ".$this->globalConfig[''tab''][''art_lang'']."\r\n                    WHERE\r\n                        idart = ''".$iArticleId."'' AND\r\n                        idlang = ''".$iLangId."''\r\n                    ";\r\n\r\n        #echo "<pre>$sqlString</pre>";\r\n        $this->oDBInstance->query($sqlString);\r\n\r\n        if ($this->oDBInstance->next_record()) {\r\n            return $this->oDBInstance->f(''artspec'');\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n?> ', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:03', '2016-07-22 14:28:44');
INSERT INTO `!PREFIX!_mod` VALUES (23, 1, 'Secure Website, Exclude Pages', 'Head', 'none', 'Sichert Bereiche der Website mit Login und Passwort, einzelne Bereiche (Baeume/Kategorien) koennen ausgeschlossen werden.\n\nAutor:    Spider IT Deutschland - Rene Mansveld (www.Spider-IT.de)\nVersion:  1.1 (2013-03-12)\n\nChanges:\nV.1.1 (2013-03-12):\n - NEW: Einstellungen "include" und "exclude" statt "idcats" fuer mehr Flexibilitaet\n - NEW: Erweitert fuer den Einsatz beim PHP CGI-Modul\n\nV.1.0 (2013-03-02)\n - First Release', NULL, '/**\n * Damit die Anmeldung auf jeden Fall funktioniert, auch wenn PHP als CGI-Modul laeuft, muessen die folgenden Zeilen\n * in eine/die .htaccess Datei direkt nach "RewriteEngine on" eingefuegt werden:\n *   # Enable PHP security\n *   RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\n *\n * Steuerbar ueber die folgenden Mandanteneinstellungen:\n * Typ:  secure\n * Name: login\n * Wert: (Gewuenschter Benutzername, Standard is "webseite" oder Uebersetzung)\n *\n * Typ:  secure\n * Name: password\n * Wert: (Gewuenschtes Passwort, Standard ist "zeigen" oder Uebersetzung)\n *\n * Typ:  secure\n * Name: realm\n * Wert: (Text, der in Loginfenster gezeigt werden soll, Standard is "Nur Personal" oder Uebersetzung)\n *\n * Typ:  secure\n * Name: exclude\n * Wert: (Liste der auszuschliessenden idcats, Komma getrennt ohne Leerstellen, Standard ist "0" fuer alle Kategorien ausser include)\n *\n * Typ:  secure\n * Name: include\n * Wert: (Liste der zu sperrenden idcats, Komma getrennt ohne Leerstellen, Standard ist "0", "-1" sperrt alles bis auf exclude)\n */', '<?php\n# Einstellungen einlesen\n$sLogin     = getEffectiveSetting(''secure'', ''login'', mi18n("webseite"));\n$sPassword  = getEffectiveSetting(''secure'', ''password'', mi18n("zeigen"));\n$sRealm     = getEffectiveSetting(''secure'', ''realm'', mi18n("Nur Personal"));\n$aExclude   = explode('','', getEffectiveSetting(''secure'', ''exclude'', ''0''));\n$aInclude   = explode('','', getEffectiveSetting(''secure'', ''include'', ''0''));\n\nif (((count($aExclude) == 1) && (intval($aExclude[0]) == 0) && (count($aInclude) == 1) && (intval($aInclude[0]) == 0)) || ($contenido)) {\n    # Keine Sperrung eingerichtet\n} else {\n    # Nachsehen, ob diese Kategorie im Include- oder Exclude-Bereich ist\n    $iPid = $idcat;\n    while ($iPid != 0) {\n        if ((in_array($iPid, $aExclude)) || (in_array($iPid, $aInclude))) {\n            break;\n        }\n        $sql = ''SELECT parentid\n                FROM '' . $cfg[''tab''][''cat''] . ''\n                WHERE ((idclient='' . $client . '')\n                   AND (idcat='' . $iPid . ''))'';\n        $db->query($sql);\n        $db->next_record();\n        $iPid = $db->f(''parentid'');\n    }\n    # Wenn die Kategorie nicht im Exclude-Bereich ist, oder in keins der Bereiche, dann sperren\n    if ((($iPid > 0) && (!in_array($iPid, $aExclude))) || ($iPid == 0)) {\n        # "Normale" Variablen fuer die Anmeldung pruefen\n        if (($_SERVER[''PHP_AUTH_USER''] != $sLogin) || ($_SERVER[''PHP_AUTH_PW''] != $sPassword)) {\n            # Variablen fuer die Anmeldung aus CGI-Modus pruefen\n            if (isset($_SERVER[''HTTP_AUTHORIZATION''])) {\n                list($user, $pw) = explode('':'', base64_decode(substr($_SERVER[''HTTP_AUTHORIZATION''], 6)));\n            } elseif (isset($_SERVER[''REDIRECT_HTTP_AUTHORIZATION''])) {\n                list($user, $pw) = explode('':'', base64_decode(substr($_SERVER[''REDIRECT_HTTP_AUTHORIZATION''], 6)));\n            }\n            if (($user != $sLogin) || ($pw != $sPassword)) {\n                # Sperrdaten ausgeben und Verarbeitung abbrechen\n                Header(''HTTP/1.1 401 Unauthorized'');\n                Header(''WWW-Authenticate: Basic realm="'' . $sRealm . ''"'');\n                die(''401 Unauthorized'');\n            }\n        }\n    }\n}\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-09-17 11:23:39', '0000-00-00 00:00:00');
INSERT INTO `!PREFIX!_mod` VALUES (24, 1, 'Simple Gallery', 'Content', 'none', 'Einfache Bildergalerie mit 1 Bild mit Beschreibung angezeigt, vor-/zurueck Navigation und Anzeige Bildnummer und Anzahl Bilder.\r\nEin Popup mit grosses Bild, Thumbnail-Navigation und Beschreibung kann zugeschaltet werden.\r\n\r\nSimple image gallery showing one image with it''s description, navigation and image numbers.\r\nA popup for larger versions of the images can be enabled.\r\nOn desktop computers (non touch screen), a popup showing large images and thumbs will be shown then,\r\non mobile devices (touch screen), a PhotoSwipe overlay shows the large images full screen, allowing the visitor to swipe to the next.\r\n\r\nAuthor:   Spider IT Deutschland - Rene Mansveld (www.Spider-IT.de)\r\nVersion:  1.8 (2013-10-04)\r\n\r\nChanges:\r\n2013-10-04 - V.1.8:\r\n - NEW: Optimized for Responsive Design integrating PhotoSwipe (www.photoswipe.com) for mobile devices\r\n\r\nV.1.7 (2013-02-25):\r\n - BUGFIX: Upcounting the variable for multiple use doesn''t work with ''++'', uses ''+ 1'' now\r\n\r\nV.1.6 (2013-01-26):\r\n - UPDATE: Corrected the height of the marker of the thumbnails\r\n\r\nV.1.5 (2012-11-26):\r\n - NEW: Common description added (shown when an image doesn''t have it''s own description)\r\n - NEW: Large images (popup) are preloaded on showing the next or previous large image\r\n\r\nV.1.4 (2012-11-25):\r\n - NEW: Overlay image on hovering the image when a popup is available\r\n - NEW: Image navigation in the popup on hovering over the large image\r\n\r\nV.1.3 (2012-11-24):\r\n - NEW: Current thumb marking with border and image number (x/y)\r\n - NEW: Image selection in the popup by mouse hover on the thumb\r\n - NEW: Thumbnails are now loaded on showing the popup (faster page loading)\r\n\r\nV.1.2 (2012-11-23):\r\n - NEW: Thumbnails in the popup are now shown as slider\r\n - NEW: Cachetime is set per image randomly (60-3600 minutes, reduces delays)\r\n - BUGFIX: Transparent/white background didn''t work partially\r\n\r\nV.1.1 (2012-11-22):\r\n - NEW: Additional popup with larger image, Thumbnails and description\r\n\r\nV.1.0 (2012-11-21):\r\n - First release', NULL, '?>\r\n<table>\r\n    <tr>\r\n        <td><?php echo mi18n("Images folder"); ?></td>\r\n        <td>\r\n            <select name="<?php echo "CMS_VAR[0]"; ?>" style="width: 400px;">\r\n                <option value="">- <?php echo mi18n("Please select"); ?> -</option>\r\n<?php\r\n$sql = ''SELECT DISTINCT dirname\r\n        FROM '' . $cfg[''tab''][''upl''] . ''\r\n        WHERE ((filetype IN ("jpg", "jpeg", "gif", "png"))\r\n           AND (idclient='' . $client . ''))\r\n        ORDER BY dirname'';\r\n$db->query($sql);\r\nwhile ($db->next_record()) {\r\n?>\r\n                <option value="<?php echo $db->f(''dirname''); ?>"<?php echo (($db->f(''dirname'') == "CMS_VALUE[0]") ? '' selected="selected"'' : ''''); ?>><?php echo $db->f(''dirname''); ?></option>\r\n<?php\r\n}\r\n?>\r\n            </select>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Common description"); ?><br /><span style="color: #999;">(<?php echo mi18n("shown when no image description was found"); ?>)</span></td>\r\n        <td>\r\n            <textarea id="<?php echo "CMS_VAR[6]"; ?>" name="<?php echo "CMS_VAR[6]"; ?>" cols="0" rows="0" style="width: 400px; height: 150px;"><?php echo "CMS_VALUE[6]"; ?></textarea>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Size of the image area (W x H)"); ?></td>\r\n        <td>\r\n            <input type="text" name="<?php echo "CMS_VAR[1]"; ?>" value="<?php echo "CMS_VALUE[1]"; ?>" style="width: 40px; text-align: right;">\r\n            x\r\n            <input type="text" name="<?php echo "CMS_VAR[2]"; ?>" value="<?php echo "CMS_VALUE[2]"; ?>" style="width: 40px; text-align: right;">\r\n            px.\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Use zoom"); ?></td>\r\n        <td>\r\n            <input type="checkbox" id="<?php echo "CMS_VAR[3]"; ?>" name="<?php echo "CMS_VAR[3]"; ?>" value="1"<?php echo ((intval("CMS_VALUE[3]") == 1) ? '' checked="checked"'' : ''''); ?> />\r\n            <label for="<?php echo "CMS_VAR[3]"; ?>"><?php echo mi18n("yes please"); ?></label>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Size of the popup image area (W x H)"); ?></td>\r\n        <td>\r\n            <input type="text" name="<?php echo "CMS_VAR[4]"; ?>" value="<?php echo "CMS_VALUE[4]"; ?>" style="width: 40px; text-align: right;">\r\n            x\r\n            <input type="text" name="<?php echo "CMS_VAR[5]"; ?>" value="<?php echo "CMS_VALUE[5]"; ?>" style="width: 40px; text-align: right;">\r\n            px. &nbsp; <span style="color: #F00;"><?php echo mi18n("Thumbnails and description are added!"); ?></span>\r\n        </td>\r\n    </tr>\r\n</table>\r\n<?php', '<?php\r\ncInclude(''frontend'', ''includes/spider-it.functions.inc.php'');\r\n\r\n# Konfiguration\r\n$sDir           = "CMS_VALUE[0]";\r\n$iWidth         = intval("CMS_VALUE[1]");\r\n$iHeight        = intval("CMS_VALUE[2]");\r\n$bUseZoom       = intval("CMS_VALUE[3]");\r\n$iZoomWidth     = intval("CMS_VALUE[4]");\r\n$iZoomHeight    = intval("CMS_VALUE[5]");\r\n\r\n# Mehrfacheinsatz\r\n$iInstance       = ((isset($iInstance)) ? ($iInstance + 1) : 1);\r\n\r\n# Bilddateien auflisten\r\n$aImg = array();\r\n$sql = ''SELECT idupl, filename\r\n        FROM '' . $cfg[''tab''][''upl''] . ''\r\n        WHERE ((dirname="'' . $sDir . ''")\r\n           AND (filetype IN ("jpg", "jpeg", "gif", "png"))\r\n           AND (idclient='' . $client . ''))\r\n        ORDER BY filename'';\r\n$db->query($sql);\r\nwhile ($db->next_record()) {\r\n    $aImg[] = array(''idupl'' => $db->f(''idupl''), ''orig'' => ''upload/'' . $sDir . $db->f(''filename''));\r\n}\r\n\r\nif (count($aImg)) {\r\n    # Bilder skalieren und Beschreibung holen\r\n    for ($i = 0, $n = count($aImg); $i < $n; $i ++) {\r\n        # sitImgScale($img, $maxX = 0, $maxY = 0, $crop = false, $expand = false, $cacheTime = 10, $wantHQ = true, $quality = 75, $keepType = false, $fixedSize = false, $fixedBG = ''FFFFFF'');\r\n        $timeout = mt_rand(60, 3600);\r\n        $aImg[$i][''screen''] = sitImgScale($aImg[$i][''orig''], $iWidth, $iHeight, false, false, $timeout, true, 75, false, true, ''FFFFFF'');\r\n        if ($bUseZoom) {\r\n            $timeout = mt_rand(60, 3600);\r\n            $aImg[$i][''thumb''] = sitImgScale($aImg[$i][''orig''], 100, 75, false, false, $timeout, true, 75, false, true, ''FFFFFF'');\r\n            $timeout = mt_rand(60, 3600);\r\n            $aImg[$i][''large''] = sitImgScale($aImg[$i][''orig''], $iZoomWidth, $iZoomHeight, false, false, $timeout, true, 75, false, true, ''DDDDDD'');\r\n        }\r\n        $aImg[$i][''descr''] = sitGetImageDescription($aImg[$i][''idupl'']);\r\n        if (strlen(trim($aImg[$i][''descr''])) == 0) {\r\n            $aImg[$i][''descr''] = str_replace(array("\\r\\n", "\\n"), ''<br />'', "CMS_VALUE[6]");\r\n        }\r\n    }\r\n\r\n    # Ausgabe\r\n    $tpl = new Template();\r\n    $tpl->set(''s'', ''NUM_IMAGES'', count($aImg));\r\n    $sImagesArray       = '''';\r\n    $sThumbsArray       = '''';\r\n    $sPopupsArray       = '''';\r\n    $sDescrArray        = '''';\r\n    $sPreload           = '''';\r\n    $sPreloadThumbs     = '''';\r\n    $sPreloadLarges     = '''';\r\n    $iThumbsPerLine     = floor(($iZoomWidth - 26) / 108);\r\n    $iThumbBlockWidth   = floor((($iZoomWidth - 26) / $iThumbsPerLine) - 8);\r\n    $iThumbBlockHeight  = 85;\r\n    $j = 0;\r\n    for ($i = 0, $n = count($aImg); $i < $n; $i ++) {\r\n        $sImagesArray .= ''"'' . $aImg[$i][''screen''] . ''", '';\r\n        if ($bUseZoom) {\r\n            if (($i % $iThumbsPerLine) == 0) {\r\n                $j ++;\r\n                $sThumbsArray = (($i > 0) ? substr($sThumbsArray, 0, -2) . '');\r\n            '' : '''') . ''aThumbs'' . $iInstance . ''['' . $j . ''] = new Array("'' . $aImg[$i][''thumb''] . ''", '';\r\n            } else {\r\n                $sThumbsArray .= ''"'' . $aImg[$i][''thumb''] . ''", '';\r\n            }\r\n            $sPopupsArray .= ''"'' . $aImg[$i][''large''] . ''", '';\r\n            $sSwipeList .= ''<li id="Gallery'' . $iInstance . ''Image'' . ($i + 1) . ''" style="display: none;"><a href="'' . $aImg[$i][''large''] . ''" style="display: block;"><img src="'' . $aImg[$i][''screen''] . ''" alt="'' . $aImg[$i][''descr''] . ''" style="max-width: 100%;" /></a></li>\r\n                    '';\r\n        } else {\r\n            $sSwipeList .= ''<li id="Gallery'' . $iInstance . ''Image'' . ($i + 1) . ''" style="display: none;"><img src="'' . $aImg[$i][''screen''] . ''" alt="'' . $aImg[$i][''descr''] . ''" style="max-width: 100%;" /></li>\r\n                            '';\r\n        }\r\n        $sDescrArray .= ''"'' . str_replace(array(''&lt;br&gt;'', ''&lt;br /&gt;''), ''<br />'', htmlspecialchars($aImg[$i][''descr''])) . ''", '';\r\n        $sPreload .= ''var ImgN'' . ($i + 1 + ($iInstance * 1000)) . '' = new Image; ImgN'' . ($i + 1 + ($iInstance * 1000)) . ''.src = "'' . $aImg[$i][''screen''] . ''";\r\n        '';\r\n        $sPreloadThumbs .= ''var ImgT'' . ($i + 1 + ($iInstance * 1000)) . '' = new Image; ImgT'' . ($i + 1 + ($iInstance * 1000)) . ''.src = "'' . $aImg[$i][''thumb''] . ''";\r\n            '';\r\n        $sPreloadLarges .= ''var ImgL'' . ($i + 1 + ($iInstance * 1000)) . '' = new Image; ImgL'' . ($i + 1 + ($iInstance * 1000)) . ''.src = "'' . $aImg[$i][''large''] . ''";\r\n            '';\r\n    }\r\n    $tpl->set(''s'', ''IMAGES_ARRAY'', substr($sImagesArray, 0, -2));\r\n    $tpl->set(''s'', ''THUMBS_ARRAY'', substr($sThumbsArray, 0, -2) . (($bUseZoom) ? '');'' : ''''));\r\n    $tpl->set(''s'', ''THUMBS_PER_ARRAY'', $iThumbsPerLine);\r\n    $tpl->set(''s'', ''THUMB_ARRAYS'', ceil(count($aImg) / $iThumbsPerLine));\r\n    $tpl->set(''s'', ''POPUPS_ARRAY'', substr($sPopupsArray, 0, -2));\r\n    $tpl->set(''s'', ''DESCR_ARRAY'', substr($sDescrArray, 0, -2));\r\n    $tpl->set(''s'', ''PRELOAD_IMAGES'', $sPreload);\r\n    $tpl->set(''s'', ''PRELOAD_THUMB_IMAGES'', substr($sPreloadThumbs, 0, -14));\r\n    $tpl->set(''s'', ''PRELOAD_LARGE_IMAGES'', substr($sPreloadLarges, 0, -14));\r\n    $tpl->set(''s'', ''USE_POPUP'', $bUseZoom);\r\n    $tpl->set(''s'', ''THUMB_BLOCK_WIDTH'', $iThumbBlockWidth);\r\n    $tpl->set(''s'', ''THUMB_BLOCK_HEIGHT'', $iThumbBlockHeight);\r\n    $tpl->set(''s'', ''INSTANCE'', $iInstance);\r\n    $tpl->set(''s'', ''WIDTH'', ($iWidth + 100));\r\n    $tpl->set(''s'', ''IMAGE_WIDTH'', $iWidth);\r\n    $tpl->set(''s'', ''IMAGE_HEIGHT'', $iHeight);\r\n    $tpl->set(''s'', ''POPUP_WIDTH'', ($iZoomWidth + 228));\r\n    $tpl->set(''s'', ''POPUP_HEIGHT'', ($iZoomHeight + 109));\r\n    $tpl->set(''s'', ''POPUP_HALF_WIDTH'', (($iZoomWidth + 244) / 2));\r\n    $tpl->set(''s'', ''POPUP_HALF_HEIGHT'', (($iZoomHeight + 125) / 2));\r\n    $tpl->set(''s'', ''POPUP_IMAGE_WIDTH'', $iZoomWidth);\r\n    $tpl->set(''s'', ''POPUP_IMAGE_HEIGHT'', $iZoomHeight);\r\n    $tpl->set(''s'', ''SWIPE'', $sSwipeList);\r\n    $tpl->generate(''templates/simple-gallery.html'', false, false);\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 15:59:06', '2013-10-13 12:28:27');
INSERT INTO `!PREFIX!_mod` VALUES (25, 1, 'Sitemap', 'Content', 'none', '', NULL, '?><?php\r\n/**\r\n * Project: \r\n * contenido.org\r\n * \r\n * Description: \r\n * Simple sitemap\r\n * \r\n * Requirements: \r\n * @con_php_req 5.0\r\n * \r\n *\r\n * @version    0.1.0\r\n * @author     Rudi Bieller\r\n * @copyright  four for business AG <www.4fb.de>\r\n * @license    http://www.contenido.org/license/LIZENZ.txt\r\n * @link       http://www.4fb.de\r\n * @link       http://www.contenido.org\r\n * @todo move function to load all categories somewhere else...\r\n * @todo use some template instead of html in code...\r\n * \r\n * {@internal \r\n *   created 2009-01-05\r\n *   $Id$\r\n * }}\r\n * \r\n */\r\n\r\nif (!isset($db)) {\r\n    $db = new DB();\r\n}\r\n\r\n$iSelectedCat = intval("CMS_VALUE[1]");\r\n$iSelectedDepth = intval("CMS_VALUE[2]");\r\n$iSelectedHtmlOutputStyle = intval("CMS_VALUE[3]");\r\n$aAllCategories = sitemap_getAllCategories($db, $cfg, $lang, $client);\r\n$sOptionsCategories = '''';\r\n$sOptionsDepth = '''';\r\n$sSelectedHtmlStyle0 = $iSelectedHtmlOutputStyle == 0 ? '' selected="selected"'' : '''';\r\n$sSelectedHtmlStyle1 = $iSelectedHtmlOutputStyle == 1 ? '' selected="selected"'' : '''';\r\n\r\n$sHtmlTable = ''<table border="0" cellpadding="10" cellspacing="0"> \r\n    <tr>\r\n        <td>''.mi18n("Kategorie w?hlen:").''</td> \r\n        <td>\r\n            <select name="'' . "CMS_VAR[1]" . ''"> \r\n                <option value="0">---Alle---</option>\r\n                [SNIP_CATEGORIES]\r\n            </select>\r\n        </td>\r\n</tr> \r\n<tr> \r\n    <td>''.mi18n("Maximale Anzahl Ebenen:").''</td> \r\n    <td>\r\n        <select name="'' . "CMS_VAR[2]" . ''"> \r\n            <option value="0">---Select---</option>\r\n            [SNIP_DEPTH]\r\n        </select>\r\n    </td>\r\n</tr>\r\n<tr> \r\n    <td>''.mi18n("HTML Ausgabe:").''</td> \r\n    <td>\r\n        <select name="'' . "CMS_VAR[3]" . ''"> \r\n            <option value="0"''.$sSelectedHtmlStyle0.''>&lt;ul&gt;&lt;li&gt;Alle Kategorien in einer Liste&lt;/li&gt;&lt;/ul&gt;</option>\r\n            <option value="1"''.$sSelectedHtmlStyle1.''>&lt;ul&gt;&lt;li&gt;Alle Hauptkategorien in einer eigenen ul&lt;/li&gt;&lt;/ul&gt;</option>\r\n        </select>\r\n    </td>\r\n</tr>\r\n</table>\r\n'';\r\n\r\n$iSelectedCat = intval("CMS_VALUE[1]");\r\n$iSelectedDepth = intval("CMS_VALUE[2]");\r\n$aAllCategories = sitemap_getAllCategories($db, $cfg, $lang, $client);\r\n$sOptionsCategories = '''';\r\n$sOptionsDepth = '''';\r\n\r\nfor ($i = 1; $i <= 30; $i++) {\r\n    $sSelected = $iSelectedDepth == $i ? '' selected="selected"'' : '''';\r\n    $sOptionsDepth .= ''<option value="''.strval($i).''"''.$sSelected.''>''.strval($i).''</option>'';\r\n}\r\n\r\nif (sizeof($aAllCategories) > 0) {\r\n    foreach ($aAllCategories as $aCatDetails) {\r\n        $sSelected = $iSelectedCat == intval($aCatDetails[''idcat'']) ? '' selected="selected"'' : '''';\r\n        $sSpace = str_repeat(''-'', intval($aCatDetails[''level'']));\r\n        $sCssLevelZero = intval($aCatDetails[''level'']) == 0 ? '' style="background-color:#F8FDDC;"'' : '''';\r\n        $sOptionsCategories .= ''<option value="''.strval($aCatDetails[''idcat'']).''"''.$sSelected.$sCssLevelZero.''>''.$sSpace.'' ''.strval($aCatDetails[''name'']).''</option>'';\r\n    }\r\n}\r\n\r\necho str_replace(array(''[SNIP_CATEGORIES]'', ''[SNIP_DEPTH]''), array($sOptionsCategories, $sOptionsDepth), $sHtmlTable);\r\n\r\n\r\n/**\r\n * Return array with all info on ALL categories of current client/lang\r\n *\r\n * @param unknown_type $oDb\r\n * @param array $aCfg\r\n * @param unknown_type $iLang\r\n * @param unknown_type $iClient\r\n * @return unknown\r\n */\r\nfunction sitemap_getAllCategories($oDb, array $aCfg, $iLang, $iClient) {\r\n    $aResult = array();\r\n    $sSql = "SELECT\r\n            A.idcat,\r\n            A.level,\r\n            C.name\r\n          FROM\r\n            ".$aCfg[''tab''][''cat_tree'']." AS A,\r\n            ".$aCfg[''tab''][''cat'']." AS B,\r\n            ".$aCfg[''tab''][''cat_lang'']." AS C\r\n          WHERE\r\n            A.idcat=B.idcat  \r\n            AND B.idcat=C.idcat \r\n            AND C.idlang=''".intval($iLang)."''\r\n            AND B.idclient=''".intval($iClient)."'' \r\n            AND C.visible=1\r\n          ORDER BY A.idtree";\r\n    $oDb->query($sSql);\r\n    if ($oDb->Errno == 0 && $oDb->num_rows() > 0) {\r\n        while($oDb->next_record()) {\r\n            $aResult[] = array(\r\n                                ''idcat'' => intval($oDb->f(''idcat'')), \r\n                                ''level'' => intval($oDb->f(''level'')), \r\n                                ''name'' => strval($oDb->f(''name''))\r\n                                );\r\n        }\r\n    }\r\n    return $aResult;\r\n}', '<?php\r\n/**\r\n * Project: \r\n * contenido.org\r\n * \r\n * Description: \r\n * Simple sitemap.\r\n * Can output all categories in one list or each main category as separate list\r\n * \r\n * To modify the behaviour of the module (e.g. style of URL, CSS classes, ...), you need to edit Contenido_Sitemap_Util::loopCats\r\n * @see {frontend}/includes/Util/Modules/Contenido_Sitemap_Util.class.php\r\n * \r\n * Requirements: \r\n * @con_php_req 5.0\r\n * \r\n *\r\n * @version    0.1.0\r\n * @author     Rudi Bieller\r\n * @copyright  four for business AG <www.4fb.de>\r\n */\r\n\r\nif (!isset($db)) {\r\n    $db = new DB();\r\n}\r\nif (!isset($tpl)) {\r\n    $tpl = new Template();\r\n}\r\n$tpl->reset();\r\n\r\ncInclude(''frontend'', ''includes/Util/Modules/Contenido_Sitemap_Util.class.php'');\r\n\r\n$iSelectedCat = intval("CMS_VALUE[1]");\r\n$iSelectedDepth = intval("CMS_VALUE[2]");\r\n$iHtmlOutputType = intval("CMS_VALUE[3]");\r\n$sUrlStyle = $cfg[''url_builder''][''name''];\r\n\r\nif ($iSelectedCat > 0 && $iSelectedDepth >= 0) {\r\n    $oFeNav = new Contenido_FrontendNavigation($db, $cfg, $client, $lang, $cfgClient);\r\n    $oFeNav->setAuth($auth);\r\n    $oSubCategories = $oFeNav->getSubCategories($iSelectedCat, true, true, 1);\r\n    // see if there are any subcategories to display\r\n    if ($oSubCategories->count() > 0) {\r\n        $aDepthInfo = array();\r\n        $aDepthInfo[0] = 0;\r\n        $aDepthInfo[1] = $iSelectedDepth;\r\n        if ($iHtmlOutputType == 1) {\r\n            $sMainCats = '''';\r\n        }\r\n        foreach ($oSubCategories as $oSubCategory) {\r\n            switch($iHtmlOutputType) {\r\n                case 0:\r\n                    Contenido_Sitemap_Util::loopCats($oSubCategory, $oFeNav, $tpl, $sUrlStyle, $cfg, $lang, $aDepthInfo);\r\n                    break;\r\n                case 1:\r\n                    $tpl->reset();\r\n                    Contenido_Sitemap_Util::loopCats($oSubCategory, $oFeNav, $tpl, $sUrlStyle, $cfg, $lang, $aDepthInfo);\r\n                    $sSubCats = $tpl->generate(''templates/sitemap_standard_li.html'', true);\r\n                    $tpl->reset();\r\n                    $tpl->set(''s'', ''list_items'', $sSubCats);\r\n                    $sMainCats .= $tpl->generate(''templates/sitemap_standard_ul.html'', true);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        if ($iHtmlOutputType == 0) {\r\n            $tpl->generate(''templates/sitemap_standard.html'');\r\n        } else {\r\n            echo $sMainCats;\r\n        }\r\n    }\r\n} else {\r\n    echo ''<p>Sitemap not configured correctly.</p>'';\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:14', '2013-09-14 14:57:38');
INSERT INTO `!PREFIX!_mod` VALUES (26, 1, 'Sub_Headline', 'Content', 'none', 'Output standard h2 subheadline', NULL, '', '<?php\r\n/**\r\n* $RCSfile$\r\n*\r\n* Description: Output standard h2 subheadline\r\n*\r\n* @version 1.0.0\r\n* @author Rudi Bieller\r\n* @copyright four for business AG <www.4fb.de>\r\n*\r\n* {@internal\r\n* created 2008-04-07\r\n* }}\r\n*/\r\n\r\n$sText = "CMS_HTMLHEAD[2]";\r\n\r\nif (!isset($tpl) || !is_object($tpl)) {\r\n    $tpl = new Template();\r\n}\r\n\r\n$tpl->reset();\r\nif ($contenido && $edit) {\r\n    $tpl->set(''s'', ''text'', $sText);\r\n    $tpl->generate(''templates/subheadline_h2.html'');\r\n} else {\r\n    if ($sText != '''') {\r\n        $tpl->set(''s'', ''text'', strip_tags($sText));\r\n        $tpl->generate(''templates/subheadline_h2.html'');\r\n    }\r\n}\r\n\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:26', '2013-09-14 14:57:48');
INSERT INTO `!PREFIX!_mod` VALUES (27, 1, 'Teaser_Right', 'Content', 'none', 'Display teaser on right side', NULL, '', '<?php\r\n/**\r\n* $RCSfile$\r\n*\r\n* Description: Display teaser on right side\r\n*\r\n* @version 1.0.0\r\n* @author Rudi Bieller\r\n* @copyright four for business AG <www.4fb.de>\r\n*\r\n* {@internal\r\n* created 2008-04-07\r\n* }}\r\n*/\r\n\r\nif (!isset($tpl) || !is_object($tpl)) {\r\n    $tpl = new Template();\r\n}\r\n\r\n$tpl->reset();\r\n$tpl->generate(''templates/teaser_right.html'');\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:37', '2013-09-14 14:57:57');
INSERT INTO `!PREFIX!_mod` VALUES (28, 1, 'Text', 'Content', 'none', 'Displays CMS_HTML Element', NULL, '', '<?php\r\n/**\r\n* $RCSfile$\r\n*\r\n* Description: Output some HTML text\r\n*\r\n* @version 1.0.0\r\n* @author Rudi Bieller\r\n* @copyright four for business AG <www.4fb.de>\r\n*\r\n* {@internal\r\n* created 2008-04-07\r\n* }}\r\n*/\r\n\r\nif (!isset($tpl) || !is_object($tpl)) {\r\n    $tpl = new Template();\r\n}\r\n\r\n$tpl->reset();\r\n$tpl->set(''s'', ''text'', "CMS_HTML[1]");\r\n$tpl->generate(''templates/text_html.html'');\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:53', '2013-09-14 14:58:08');
INSERT INTO `!PREFIX!_mod` VALUES (29, 1, 'Title', 'Head', 'none', 'Ersetzt dem Seitentitel vom drugCMS-System (braucht nicht mehr angegeben werden).\r\nWird dennoch ein Seitentitel eingetragen, so hat dieser Vorrang vor dieses Modul.\r\n\r\nAutor:    Spider IT Deutschland - Rene Mansveld (www.Spider-IT.de)\r\nVersion:  1.2 (2013-01-23)\r\n\r\nChanges:\r\nVersion 1.2 (2013-01-23):\r\n - UPDATE: Direkte Datenbankabfragen entfernt und durch Systemaufrufe ersetzt\r\n\r\nVersion 1.1 (2012-09-06):\r\n - NEW: Titel des Artikels angehaengt wenn dieser nicht Startartikel ist\r\n\r\nVersion 1.0 (2011-12-05):\r\n - Erstes Release', NULL, '', '<?php\r\n# Exchange the separator sign for your needs\r\n$sSeparator = '' &bull; '';\r\n\r\n# For use in title tag and in page content, only generate once\r\nif (!isset($sitLocation)) {\r\n    # Get path to root\r\n    conCreateLocationString($idcat, html_entity_decode($sSeparator, ENT_QUOTES, $encoding[$lang]), $sitLocation, false, '''', 1);\r\n    # Check if article is start article\r\n    if (!isStartArticle($idartlang, $idcat, $lang)) {\r\n        # It''s not, put the article title at the end\r\n        $oArt = new Article($idart, $client, $lang, $idartlang);\r\n        $sitLocation .= ((strlen($sitLocation)) ? html_entity_decode($sSeparator, ENT_QUOTES, $encoding[$lang]) : '''') . $oArt->getField(''title'');\r\n    }\r\n    # If we don''t have a location, just write ''Home''\r\n    $sitLocation = ((strlen($sitLocation)) ? $sitLocation : ''Home'');\r\n    # Put the client name in front\r\n    $oClient = new Client();\r\n    $aClients = $oClient->getAvailableClients();\r\n    $sClientName = $aClients[$client][''name''];\r\n    $sitLocation = $sClientName . html_entity_decode($sSeparator, ENT_QUOTES, $encoding[$lang]) . $sitLocation;\r\n}\r\n# Output\r\necho $sitLocation;\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2008-04-14 16:00:53', '2013-09-18 14:44:18');
INSERT INTO `!PREFIX!_mod` VALUES (30, 1, 'QR Text', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php echo mi18n("Diese Seite auf dem Smartphone:"); ?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-09-17 11:33:07', '2013-09-17 11:33:23');
INSERT INTO `!PREFIX!_mod` VALUES (31, 1, 'MegaMenu', 'Navigation', 'none', 'Displays a Multi-Level Mega Menu (nested) Navigation starting from the selected tree/category, a dropdown navigation on mobile devises.\r\n\r\nAuthor:   Spider IT Deutschland - Rene Mansveld (www.Spider-IT.de)\r\nVersion:  1.0 (2013-09-18)\r\nBase:     jQuery Mega Drop Down Menu Plugin (www.designchemical.com/lab/jquery-mega-drop-down-menu-plugin/)\r\n          FlexNav - A jQuery Plugin for Responsive Menus (http://jasonweaver.name/lab/flexiblenavigation/)', NULL, '?>\r\n<table>\r\n    <tr>\r\n        <td style="width: 40%;"><?php echo mi18n("Start from category"); ?></td>\r\n        <td style="width: 60%;"><input type="text" name="<?php echo "CMS_VAR[0]"; ?>" value="<?php echo "CMS_VALUE[0]"; ?>" style="width: 30px; text-align: right;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Color"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[2]"; ?>" value="<?php echo "CMS_VALUE[2]"; ?>" style="width: 100px;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Items per row"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[3]"; ?>" value="<?php echo "CMS_VALUE[3]"; ?>" style="width: 30px; text-align: right;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Animate time"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[4]"; ?>" value="<?php echo "CMS_VALUE[4]"; ?>" style="width: 40px; text-align: right;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Effect"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[5]"; ?>" value="<?php echo "CMS_VALUE[5]"; ?>" style="width: 100px;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Event"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[6]"; ?>" value="<?php echo "CMS_VALUE[6]"; ?>" style="width: 100px;" /> <span style="color: #666;">(<?php echo mi18n("only on non touch screens"); ?>)</span></td>\r\n    </tr>\r\n    <tr>\r\n        <td><?php echo mi18n("Full width"); ?></td>\r\n        <td><input type="text" name="<?php echo "CMS_VAR[7]"; ?>" value="<?php echo "CMS_VALUE[7]"; ?>" style="width: 100px;" /></td>\r\n    </tr>\r\n    <tr>\r\n        <td colspan="2">\r\n            <div style="padding: 4px 6px; background-color: #FFD; border: 1px solid #AAA; border-radius: 7px;">\r\n                <?php echo mi18n("These settings can also be made in the client settings"); ?>:<br />\r\n                &nbsp;- MegaMenu - StartCat - <strong>1</strong><br />\r\n                &nbsp;- MegaMenu - Color - <strong>black</strong><br />\r\n                &nbsp;- MegaMenu - ItemsPerRow - <strong>2</strong><br />\r\n                &nbsp;- MegaMenu - AnimateTime - <strong>300</strong><br />\r\n                &nbsp;- MegaMenu - Effect - <strong>slide</strong><br />\r\n                &nbsp;- MegaMenu - Event - <strong>hover</strong><br />\r\n                &nbsp;- MegaMenu - FullWidth - <strong>false</strong><br />\r\n                <?php echo mi18n("The here mentioned values are the default values.<br />The settings made above overwrite the client settings for this area (category / article).<br />Available colors are:"); ?> black, blue, green, grey, light_blue, orange, red, white (<?php echo mi18n("expandable, see &lt;color&gt;.css"); ?>).<br />\r\n                <?php echo mi18n("Available effects are:"); ?> slide, fade.<br />\r\n                <?php echo mi18n("Available events are:"); ?> hover, click.\r\n            </div>\r\n        </td>\r\n    </tr>\r\n</table>\r\n<?php', '<?php\r\n# Includes\r\ncInclude(''frontend'', ''includes/functions.navigation.php'');\r\n\r\n# Settings\r\n$iStartCat      = ((strlen("CMS_VALUE[0]")) ? intval("CMS_VALUE[0]") : intval(getEffectiveSetting(''MegaMenu'', ''StartCat'', 1)));\r\n$sColor         = ((strlen("CMS_VALUE[2]")) ? "CMS_VALUE[2]" : getEffectiveSetting(''MegaMenu'', ''Color'', ''black''));\r\n$iItemsPerRow   = ((strlen("CMS_VALUE[3]")) ? intval("CMS_VALUE[3]") : intval(getEffectiveSetting(''MegaMenu'', ''ItemsPerRow'', 2)));\r\n$iSpeed         = ((strlen("CMS_VALUE[4]")) ? intval("CMS_VALUE[4]") : intval(getEffectiveSetting(''MegaMenu'', ''Speed'', 300)));\r\n$sEffect        = ((strlen("CMS_VALUE[5]")) ? "CMS_VALUE[5]" : getEffectiveSetting(''MegaMenu'', ''Effect'', ''slide''));\r\n$sEvent         = ((strlen("CMS_VALUE[6]")) ? "CMS_VALUE[6]" : getEffectiveSetting(''MegaMenu'', ''Event'', ''hover''));\r\n$bFullWidth     = ((strlen("CMS_VALUE[7]")) ? "CMS_VALUE[7]" : getEffectiveSetting(''MegaMenu'', ''FullWidth'', ''false''));\r\n\r\n# Functions\r\nfunction sitNavi($kategorie = 0, $lvl = 1) {\r\n    global $lang, $client, $cfg, $sess, $iStartLevel, $edit;\r\n    \r\n    $db  = new DB();\r\n    $sql = ''SELECT ct.level, cl.idcatlang, cl.public, ct.idcat, cl.name, cl.public, al.redirect_url, al.external_redirect\r\n            FROM '' . $cfg[''tab''][''cat_tree''] . '' AS ct INNER JOIN '' . $cfg[''tab''][''cat''] . '' AS c ON ct.idcat = c.idcat INNER JOIN '' . $cfg[''tab''][''cat_lang''] . '' AS cl ON ct.idcat = cl.idcat LEFT JOIN '' . $cfg[''tab''][''art_lang''] . '' AS al ON cl.startidartlang = al.idartlang AND cl.idlang = al.idlang\r\n            WHERE ((cl.idlang='' . $lang . '')\r\n               AND (c.idclient='' . $client . '')\r\n               AND (c.parentid='' . $kategorie . '')\r\n               AND (cl.visible=1))\r\n            ORDER BY ct.idtree'';\r\n    $db->query($sql);\r\n    $treffer = $db->num_rows();\r\n    if ($treffer) {\r\n        $db->next_record();\r\n        $lvl = $db->f(''level'');\r\n        $db->seek();\r\n        switch ($lvl - $iStartLevel) {\r\n            case 1:\r\n                $result = "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''<ul id="nav" class="mega-menu">'';\r\n                break;\r\n            default:\r\n                $result = "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''<ul>'';\r\n                break;\r\n        }\r\n        $img = 0;\r\n        while ($db->next_record()) {\r\n            $lvl = $db->f(''level'');\r\n            $img ++;\r\n            if (checkCatPermission($db->f(''idcatlang''), $db->f(''public''))) {\r\n                $tmp = (($edit) ? '''' : sitNavi($db->f(''idcat''), (($lvl - $iStartLevel) + 1)));\r\n                $url = $sess->url(''front_content.php?idcat='' . $db->f(''idcat''));\r\n                $url = (($db->f(''external_redirect'')) ? ((substr($db->f(''redirect_url''), 0, 4) == ''http'') ? $db->f(''redirect_url'') : $url) : $url);\r\n                if ((($lvl - $iStartLevel) == 1) && (strlen($tmp) == 0)) {\r\n                    $result .= "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''    <li class="sub-container non-mega">'' . "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''        <a href="'' . $url . ''"'' . (($db->f(''external_redirect'')) ? '' target="_blank"'' : '''') . ''>'' . $db->f(''name'') . ''</a>'' . $tmp . "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''    </li>'';\r\n                } elseif (($lvl - $iStartLevel) >= 0) {\r\n                    $result .= "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''    <li>'' . "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''        <a href="'' . $url . ''"'' . (($db->f(''external_redirect'')) ? '' target="_blank"'' : '''') . ''>'' . $db->f(''name'') . ''</a>'' . $tmp . "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''    </li>'';\r\n                } else {\r\n                    $result .= $tmp;\r\n                }\r\n            }\r\n        }\r\n        $result .= "\\n" . str_repeat(''    '', ((($lvl - $iStartLevel) * 2) + 1)) . ''</ul>'';\r\n    }\r\n    return $result;\r\n}\r\n\r\n# Execution\r\n$sql = ''SELECT level\r\n        FROM '' . $cfg[''tab''][''cat_tree''] . ''\r\n        WHERE (idcat='' . $iStartCat . '')'';\r\n$db->query($sql);\r\nif ($db->next_record()) {\r\n    $iStartLevel = $db->f(''level'');\r\n}\r\n$sNavi = sitNavi($iStartCat, $iStartLevel);\r\n?>\r\n\r\n<link rel="stylesheet" type="text/css" href="css/dcmegamenu.css" />\r\n<link rel="stylesheet" type="text/css" href="css/<?php echo $sColor; ?>.css" />\r\n<link rel="stylesheet" type="text/css" href="css/flexnav.css" />\r\n<script type=''text/javascript'' src=''js/jquery.hoverIntent.minified.js''></script>\r\n<script type=''text/javascript'' src=''js/jquery.dcmegamenu.1.3.3.js''></script>\r\n<script type="text/javascript" src="js/jquery.flexnav.min.js"></script>\r\n<?php if (!$edit) { ?>\r\n<script type="text/javascript">\r\n//<![CDATA[\r\n    $(document).ready(function($){\r\n        $(''#nav'').dcMegaMenu({\r\n            fullWidth: <?php echo $bFullWidth; ?>,\r\n            rowItems: ''<?php echo $iItemsPerRow; ?>'',\r\n            speed: <?php echo $iSpeed; ?>,\r\n            effect: ''<?php echo $sEffect; ?>'',\r\n            event: ((''ontouchstart'' in document.documentElement) ? ''click'' : ''<?php echo $sEvent; ?>'')\r\n        });\r\n        $(".flexnav").flexNav();\r\n    });\r\n//]]>\r\n</script>\r\n<?php } ?>\r\n<div class="navbar">\r\n    <div class="desktop">\r\n        <div class="<?php echo str_replace(''_'', ''-'', $sColor); ?>"><?php echo $sNavi . "\\n"; ?>\r\n        </div>\r\n    </div>\r\n    <div class="mobile">\r\n        <div class="menu-button <?php echo str_replace(''_'', ''-'', $sColor); ?>"><ul class="mega-menu"><li><a href="javascript: void(0);"><?php echo mi18n("Menu"); ?></a></li></ul></div><?php echo str_replace(''id="nav" class="mega-menu"'', ''class="flexnav"'', $sNavi) . "\\n"; ?>\r\n    </div>\r\n</div>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-09-18 10:11:58', '2014-02-10 09:44:15');
INSERT INTO `!PREFIX!_mod` VALUES (32, 1, 'HTML Start Tag', 'Head', 'none', 'Outputs the HTML start tag with a language code if set.\r\n\r\nAuthor:   Spider IT Deutschland - Rene Mansveld (www.Spider-IT.de)\r\nVersion:  1.0 (2013-09-29)', NULL, '', '<?php\r\n$sql = ''SELECT value\r\n        FROM '' . $cfg[''tab''][''properties''] . ''\r\n        WHERE ((idclient='' . $client . '')\r\n           AND (itemtype="idlang")\r\n           AND (itemid="'' . $lang . ''")\r\n           AND (type="language")\r\n           AND (name="code"))'';\r\n$db->query($sql);\r\nif ($db->next_record()) {\r\n    echo ''<html lang="'' . $db->f(''value'') . ''">'';\r\n} else {\r\n    echo ''<html>'';\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-09-29 16:48:44', '2013-09-29 17:01:01');
INSERT INTO `!PREFIX!_mod` VALUES (33, 1, 'CMS_FILELIST', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php echo "CMS_FILELIST[1]"; ?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-08 18:05:49', '2013-10-09 09:57:45');
INSERT INTO `!PREFIX!_mod` VALUES (34, 1, 'CMS_TEASER', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php echo "CMS_TEASER[1]"; ?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-09 11:07:56', '2013-10-09 11:08:27');
INSERT INTO `!PREFIX!_mod` VALUES (35, 1, 'CMS_IMG', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion', NULL, '', '<?php\r\nif ($edit) {\r\n    echo ''<div style="position: absolute; margin: 4px;">'' . "CMS_IMGEDIT[1]" . ''</div>'';\r\n}\r\n$b = "CMS_IMG[1]";\r\nif (strlen($b)) {\r\n    echo ''<img src="'' . $b . ''" alt="'' . "CMS_IMGTITLE[1]" . ''" />'';\r\n} else {\r\n    echo ''<br />'';\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-09 11:25:32', '2013-10-09 11:45:04');
INSERT INTO `!PREFIX!_mod` VALUES (36, 1, 'CMS_LINK', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php\r\n$b = "CMS_LINK[1]";\r\nif (strlen($b) > 7 /* http:// */) {\r\n    echo ''<p><a href="'' . $b . ''" target="'' . "CMS_LINKTARGET" . ''">'' . "CMS_LINKDESCR[1]" . ''</a></p>'';\r\n} elseif ($edit) {\r\n    echo ''<p>'' . "CMS_LINKDESCR[1]" . ''</p>'';\r\n} else {\r\n    echo ''<p>&nbsp;</p>'';\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-09 11:58:46', '2013-10-09 13:58:46');
INSERT INTO `!PREFIX!_mod` VALUES (37, 1, 'CMS_SWF', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php echo "CMS_SWF[1]"; ?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-09 14:01:22', '2013-10-09 14:01:49');
INSERT INTO `!PREFIX!_mod` VALUES (38, 1, 'CMS_DATE', 'Content', 'none', '<Ihre Modulbeschreibung>\r\n\r\nAutor:\r\nVersion:', NULL, '', '<?php echo "CMS_DATE[1]"; ?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-09 15:15:56', '2013-10-09 15:47:09');
INSERT INTO `!PREFIX!_mod` VALUES (39, 1, 'Symbol language select', 'Navigation', 'none', 'Show a language selection with or without icons\r\n\r\nAuthor:    Spider IT Deutschland - Rene Mansveld\r\nVersion:   1.0', NULL, '; ?>\r\n<table>\r\n    <tr>\r\n        <td colspan="2"><strong><?php echo mi18n("Flags for languages"); ?></strong></td>\r\n    </tr>\r\n<?php\r\n$sql = ''SELECT l.idlang, l.name\r\n        FROM '' . $cfg[''tab''][''clients_lang''] . '' AS cl INNER JOIN '' . $cfg[''tab''][''lang''] . '' AS l ON cl.idlang = l.idlang\r\n        WHERE (cl.idclient='' . $client . '')'';\r\n$db->query($sql);\r\nwhile ($db->next_record()) {\r\n    $i = $db->f(''idlang'');\r\n    $j = ($i + 100);\r\n?>\r\n    <tr>\r\n        <td><?php echo $db->f(''name''); ?> (<?php echo mi18n("active"); ?>):</td>\r\n        <td>\r\n            <select name="<?php echo "CMS_VAR[$i]"; ?>" size="1" style="width: 280px;" />\r\n                <option value=""><?php echo mi18n("nothing selected"); ?></option>\r\n<?php\r\n    $db2 = new DB;\r\n    $sql = "SELECT * FROM ".$cfg[''tab''][''upl'']." WHERE (filetype=''jpg'') OR (filetype=''jpeg'') OR (filetype=''gif'') OR (filetype=''png'') ORDER BY dirname, filename";\r\n    $db2->query($sql);\r\n    while ($db2->next_record()) {\r\n        $path = $db2->f("dirname") . $db2->f("filename");\r\n        if ($path == "CMS_VALUE[$i]") {\r\n?>\r\n                <option value="<?php echo $path; ?>" selected="selected"><?php echo $path; ?></option>\r\n<?php\r\n        } else {\r\n?>\r\n                <option value="<?php echo $path; ?>"><?php echo $path; ?></option>\r\n<?php\r\n        }\r\n    }\r\n?>\r\n            </select>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td>&nbsp; &nbsp; &quot; &nbsp; &nbsp; (<?php echo mi18n("inactive"); ?>):</td>\r\n        <td>\r\n            <select name="<?php echo "CMS_VAR[$j]"; ?>" size="1" style="width: 280px;" />\r\n                <option value=""><?php echo mi18n("nothing selected"); ?></option>\r\n<?php\r\n    $sql = "SELECT * FROM ".$cfg[''tab''][''upl'']." WHERE (filetype=''jpg'') OR (filetype=''jpeg'') OR (filetype=''gif'') OR (filetype=''png'') ORDER BY dirname, filename";\r\n    $db2->query($sql);\r\n    while ($db2->next_record()) {\r\n        $path = $db2->f("dirname") . $db2->f("filename");\r\n        if ($path == "CMS_VALUE[$j]") {\r\n?>\r\n                <option value="<?php echo $path; ?>" selected="selected"><?php echo $path; ?></option>\r\n<?php\r\n        } else {\r\n?>\r\n                <option value="<?php echo $path; ?>"><?php echo $path; ?></option>\r\n<?php\r\n        }\r\n    }\r\n?>\r\n            </select>\r\n        </td>\r\n    </tr>\r\n<?php\r\n}\r\n?>\r\n    <tr>\r\n        <td colspan="2">\r\n            <div style="padding: 4px 6px; background-color: #FFD; border: 1px solid #AAA; border-radius: 7px;">\r\n                <?php echo mi18n("These settings can also be made in the client settings"); ?>:<br />\r\n                &nbsp;- &lt;language name&gt; - active<br />\r\n                &nbsp;- &lt;language name&gt; - inactive<br />\r\n                <?php echo mi18n("Enter the exact path which comes behind &quot;&hellip;/upload/&quot;"); ?>.\r\n            </div>\r\n        </td>\r\n    </tr>\r\n</table>\r\n<?php', '<?php\r\n$sql = ''SELECT l.idlang, l.name\r\n        FROM '' . $cfg[''tab''][''clients_lang''] . '' AS cl INNER JOIN '' . $cfg[''tab''][''lang''] . '' AS l ON cl.idlang = l.idlang\r\n        WHERE ((cl.idclient='' . $client . '') AND (l.active=1))'';\r\n$db->query($sql);\r\nif ($db->num_rows() > 1) {\r\n    echo ''<ul id="SymbolLanguageSelect">'';\r\n    while ($db->next_record()) {\r\n        $i = $db->f(''idlang'');\r\n        $j = ($i + 100);\r\n        if ($lang == $i) {\r\n            if (strlen("CMS_VALUE[$i]")) {\r\n                echo ''<li><a href="front_content.php?changelang='' . $i . ''"><img src="upload/'' . "CMS_VALUE[$j]" . ''" alt="'' . $db->f("name") . ''" title="'' . $db->f("name") . ''" class="current" style="border: 0px none;" /></a></li>'';\r\n            } elseif (strlen(getEffectiveSetting($db->f(''name''), ''active''))) {\r\n                echo ''<li><a href="front_content.php?changelang='' . $i . ''"><img src="upload/'' . getEffectiveSetting($db->f(''name''), ''active'') . ''" alt="'' . $db->f("name") . ''" title="'' . $db->f("name") . ''" class="current" style="border: 0px none;" /></a></li>'';\r\n            } else {\r\n                # Don''t show a text link for the current language\r\n            }\r\n        } else {\r\n            if (strlen("CMS_VALUE[$i]")) {\r\n                echo ''<li><a href="front_content.php?changelang='' . $i . ''"><img src="upload/'' . "CMS_VALUE[$i]" . ''" alt="'' . $db->f("name") . ''" title="'' . $db->f("name") . ''" class="other" style="border: 0px none;" /></a></li>'';\r\n            } elseif (strlen(getEffectiveSetting($db->f(''name''), ''inactive''))) {\r\n                echo ''<li><a href="front_content.php?changelang='' . $i . ''"><img src="upload/'' . getEffectiveSetting($db->f(''name''), ''inactive'') . ''" alt="'' . $db->f("name") . ''" title="'' . $db->f("name") . ''" class="other" style="border: 0px none;" /></a></li>'';\r\n            } else {\r\n                echo ''<li><a href="front_content.php?changelang='' . $i . ''">'' . $db->f("name") . ''</a></li>'';\r\n            }\r\n        }\r\n    }\r\n    echo ''</ul>'';\r\n}\r\n?>', '', 0, NULL, NULL, '48a365b4ce1e322a55ae9017f3daf0c0', '2013-10-13 15:07:17', '2014-02-06 16:37:58');
